function initCardanoDAppConnectorBridge(r){var t,i=!1,s="DAppConnectorBridge: ",d=null,l=null,c={type:"cardano-dapp-connector-bridge",source:null,origin:null},p={},u={connect:"connect",handshake:"handshake",enable:"enable",isEnabled:"isEnabled"};function g(a){var o=[...arguments];return 0<o.length&&o.shift(),new Promise((e,n)=>{n={payload:{type:c.type,to:d,uid:("000"+(46656*Math.random()|0).toString(36)).slice(-3)+("000"+(46656*Math.random()|0).toString(36)).slice(-3),method:a,args:o},resolve:e,reject:n};p[n.payload.uid]=n,i&&console.log(s+"_requestMap:",p),c.source.postMessage(n.payload,c.origin)})}function w(e){var n,a={};for(n in e){var o=e[n];i&&console.log(s+"init: key/value:",n,o),"string"==typeof o?"feeAddress"===n?a[n]=o:(a[n]=function(e){return function(){return g(e,...arguments)}}(o),u[o]=o):a[n]="object"==typeof o?w(o):o}return a}function f(e){if(!l){if(e.data.method!==u.connect)return void console.error("Error: "+s+"send 'connect' first.");var n=e.data.initialApi;if(!(n&&n.isBridge&&n.apiVersion&&n.name))return void console.error("Error: "+s+"'connect' is missing correct initialApi.",n);if(!e.data.walletNamespace)return void console.error("Error: "+s+"'connect' is missing walletNamespace.",e.data.walletNamespace);a=e.source,o=e.origin,r=e.data.walletNamespace,n=n,window.hasOwnProperty("cardano")||(window.cardano={}),l=window.cardano.hasOwnProperty(r)?(console.warn("Warn: "+s+"window.cardano."+r+" already present, skipping initialApi creation."),null):(c.source=a,c.origin=o,d=r,o={isBridge:!0,isEnabled:function(){return g("isEnabled",...arguments)},enable:function(){return g("enable",...arguments)},supportedExtensions:n.supportedExtensions,apiVersion:n.apiVersion,name:n.name,icon:n.icon||null,experimental:{}},window.cardano[r]=o,n.experimental&&(o.experimental={...w(n.experimental)}),window.cardano[r])}var a,o,r;if(l&&window.hasOwnProperty("cardano")&&window.cardano[e.data.walletNamespace]===l)return 1;console.warn("Warn: "+s+"bridge not set up correctly:",c,l,d)}window.addEventListener("message",async function(e){if(o=e,o.data&&o.origin&&o.source&&o.data.type===c.type&&u.hasOwnProperty(o.data.method)&&(!d||o.data.walletNamespace===d)&&f(e))if(i&&(console.log("########################"),console.log(s+"onMessage: got message"),console.log(s+"onMessage: origin:",e.origin),console.log(s+"onMessage: data: ",e.data),console.log("########################")),e.data.method!==u.connect){if(e.data.uid){var n=p[e.data.uid];if(n){var a=e.data.response,o=e.data.error;if(o)return n.reject(o),void delete p[e.data.uid];e.data.method===u.enable&&("object"==typeof a&&(a=t={...w(a)},i&&console.log(s+"onMessage: fullApiObject:",t))),n.resolve(a),delete p[e.data.uid]}}}else await g("handshake")&&l&&r&&r(l)},!1)}